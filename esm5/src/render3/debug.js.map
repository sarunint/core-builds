{"version":3,"file":"debug.js","sourceRoot":"","sources":["../../../../../../packages/core/src/render3/debug.ts"],"names":[],"mappings":";;;;;;;;;;;;AAWA,OAAO,EAAiB,qBAAqB,EAAC,MAAM,kBAAkB,CAAC;AAEvE,OAAO,EAAC,gBAAgB,EAAE,WAAW,EAAE,YAAY,EAAE,WAAW,EAAC,MAAM,mBAAmB,CAAC;AAG3F,OAAO,EAAC,KAAK,EAAC,MAAM,mBAAmB,CAAC;;;;;;AAOxC;;;;;AAAA;IAAkD,wDAAqB;;;;;;;;;IACrE,qDAAc;;;;;IAAd,UAAe,OAAY,EAAE,UAA8B;;QACzD,IAAM,QAAQ,qBAAG,iBAAM,cAAc,YAAC,OAAO,EAAE,UAAU,CAAmB,EAAC;QAC7E,QAAQ,CAAC,mBAAmB,GAAG,UAAC,aAAkB,IAAK,OAAA,IAAI,mBAAmB,CAAC,aAAa,CAAC,EAAtC,CAAsC,CAAC;QAC9F,OAAO,QAAQ,CAAC;KACjB;uCA5BH;EAuBkD,qBAAqB,EAMtE,CAAA;;;;;;AAND,wCAMC;;;;;;AAOD;;;;;AAAA;IACE,6BAAoB,WAAgB;QAAhB,gBAAW,GAAX,WAAW,CAAK;KAAI;IAExC,sBAAI,0CAAS;;;;QAAb,cAA+B,OAAO,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,SAAS,CAAC,EAAE;;;OAAA;IAEhF,sBAAI,qCAAI;;;;QAAR,cAAkB,OAAO,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,SAAS,CAAC,EAAE;;;OAAA;IAEnE,sBAAI,yCAAQ;;;;QAAZ,cAA2B,OAAO,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,EAAE;;;OAAA;IAElE,sBAAI,0CAAS;;;;QAAb,cAAuB,OAAO,gBAAgB,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,EAAE;;;OAAA;IAEnE,sBAAI,+CAAc;;;;QAAlB;;YACE,IAAM,SAAS,GAAG,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;;YAChD,IAAM,SAAS,GAAG,SAAS,CAAC,SAAS,CAAC;;YACtC,IAAM,KAAK,qBAAG,SAAS,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAU,EAAC;;YAClE,IAAM,eAAe,GAAG,KAAK,CAAC,KAAK,gCAAgC,CAAC;YAEpE,IAAI,eAAe,GAAG,CAAC,EAAE;;gBACvB,IAAM,iBAAiB,GAAG,KAAK,CAAC,KAAK,wCAA0C,CAAC;;gBAChF,IAAM,eAAe,GAAG,iBAAiB,GAAG,eAAe,CAAC;;gBAC5D,IAAM,iBAAiB,GAAG,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC;;gBAChD,IAAM,aAAa,qBACf,iBAAiB,CAAC,KAAK,CAAC,iBAAiB,EAAE,eAAe,CAAwB,EAAC;gBAEvF,OAAO,aAAa,CAAC,GAAG,CAAC,UAAA,YAAY,IAAI,OAAA,YAAY,CAAC,IAAI,EAAjB,CAAiB,CAAC,CAAC;aAC7D;YAED,OAAO,EAAE,CAAC;SACX;;;OAAA;IAED,sBAAI,2CAAU;;;;QAAd,cAAyC,OAAO,YAAY,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,EAAE;;;OAAA;IAGjF,sBAAI,wCAAO;QADX,2DAA2D;;;;QAC3D,cAAqB,MAAM,IAAI,KAAK,CAAC,wBAAwB,CAAC,CAAC,EAAE;;;OAAA;IAGjE,sBAAI,uDAAsB;QAD1B,2DAA2D;;;;QAC3D,cAAoC,MAAM,IAAI,KAAK,CAAC,wBAAwB,CAAC,CAAC,EAAE;;;OAAA;IAGhF,sBAAI,2CAAU;QADd,2DAA2D;;;;QAC3D,cAAwB,MAAM,IAAI,KAAK,CAAC,wBAAwB,CAAC,CAAC,EAAE;;;OAAA;IAEpE,2DAA2D;;;;;;IAC3D,sCAAQ;;;;;IAAR,UAAS,OAAgB;QAAE,gBAAgB;aAAhB,UAAgB,EAAhB,qBAAgB,EAAhB,IAAgB;YAAhB,+BAAgB;;QAAU,OAAO,CAAC,KAAK,OAAb,OAAO,EAAU,MAAM,EAAE;KAAE;8BA9ElF;IA+EC,CAAA","sourcesContent":["/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n\nimport {Injector} from '../di/injector';\nimport {Renderer2, RendererType2} from '../render/api';\nimport {DebugContext} from '../view';\nimport {DebugRenderer2, DebugRendererFactory2} from '../view/services';\n\nimport {getHostComponent, getInjector, getLocalRefs, loadContext} from './discovery_utils';\nimport {DirectiveDef} from './interfaces/definition';\nimport {TNode, TNodeFlags} from './interfaces/node';\nimport {TVIEW} from './interfaces/view';\n\n/**\n * Adapts the DebugRendererFactory2 to create a DebugRenderer2 specific for IVY.\n *\n * The created DebugRenderer know how to create a Debug Context specific to IVY.\n */\nexport class Render3DebugRendererFactory2 extends DebugRendererFactory2 {\n  createRenderer(element: any, renderData: RendererType2|null): Renderer2 {\n    const renderer = super.createRenderer(element, renderData) as DebugRenderer2;\n    renderer.debugContextFactory = (nativeElement: any) => new Render3DebugContext(nativeElement);\n    return renderer;\n  }\n}\n\n/**\n * Stores context information about view nodes.\n *\n * Used in tests to retrieve information those nodes.\n */\nclass Render3DebugContext implements DebugContext {\n  constructor(private _nativeNode: any) {}\n\n  get nodeIndex(): number|null { return loadContext(this._nativeNode).nodeIndex; }\n\n  get view(): any { return loadContext(this._nativeNode).lViewData; }\n\n  get injector(): Injector { return getInjector(this._nativeNode); }\n\n  get component(): any { return getHostComponent(this._nativeNode); }\n\n  get providerTokens(): any[] {\n    const lDebugCtx = loadContext(this._nativeNode);\n    const lViewData = lDebugCtx.lViewData;\n    const tNode = lViewData[TVIEW].data[lDebugCtx.nodeIndex] as TNode;\n    const directivesCount = tNode.flags & TNodeFlags.DirectiveCountMask;\n\n    if (directivesCount > 0) {\n      const directiveIdxStart = tNode.flags >> TNodeFlags.DirectiveStartingIndexShift;\n      const directiveIdxEnd = directiveIdxStart + directivesCount;\n      const viewDirectiveDefs = this.view[TVIEW].data;\n      const directiveDefs =\n          viewDirectiveDefs.slice(directiveIdxStart, directiveIdxEnd) as DirectiveDef<any>[];\n\n      return directiveDefs.map(directiveDef => directiveDef.type);\n    }\n\n    return [];\n  }\n\n  get references(): {[key: string]: any} { return getLocalRefs(this._nativeNode); }\n\n  // TODO(pk): check previous implementation and re-implement\n  get context(): any { throw new Error('Not implemented in ivy'); }\n\n  // TODO(pk): check previous implementation and re-implement\n  get componentRenderElement(): any { throw new Error('Not implemented in ivy'); }\n\n  // TODO(pk): check previous implementation and re-implement\n  get renderNode(): any { throw new Error('Not implemented in ivy'); }\n\n  // TODO(pk): check previous implementation and re-implement\n  logError(console: Console, ...values: any[]): void { console.error(...values); }\n}\n"]}